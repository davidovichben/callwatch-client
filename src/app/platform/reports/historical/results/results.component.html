<div class="mb-3 flex-between">
  <p class="h1">
    <ng-container *ngIf="dates && dates.from && dates.to">
      <span>{{ 'example_report_for_dates' | t }} </span>
      <span>{{ dates.from|date: 'dd/MM/Y' }} - {{ dates.to|date: 'dd/MM/Y' }}</span>
    </ng-container>
  </p>
  <div>
    <button mat-flat-button class="ms-2 action-btn" (click)="openInformationDialog()">
      <mat-icon class="ms-1">error_outline</mat-icon>
      <span>{{ 'information' | t }}</span>
    </button>
    <button mat-flat-button class="ms-2 action-btn" (click)="produce()">
      <mat-icon class="ms-1">refresh</mat-icon>
      <span>{{ 'refresh' | t }}</span>
    </button>
    <button mat-flat-button class="ms-2 action-btn" (click)="openColumnsDialog()">
      <mat-icon class="ms-1">grid_on</mat-icon>
      <span>{{ 'columns' | t }}</span>
    </button>
    <button mat-flat-button class="ms-2 action-btn" [routerLink]="['..', 'criteria']">
      <mat-icon class="ms-1">settings</mat-icon>
      <span>{{ 'settings' | t }}</span>
    </button>
    <button mat-flat-button class="action-btn" [matMenuTriggerFor]="downloadMenu">
      <mat-icon class="ms-1">download</mat-icon>
      <span>{{ 'download' | t }}</span>
    </button>
    <mat-menu #downloadMenu="matMenu">
      <button mat-menu-item (click)="download(format)" *ngFor="let format of formats">{{ format }}</button>
    </mat-menu>
  </div>
</div>
<table class="table">
  <thead>
  <tr *ngIf="results.labels.titles.length > 0">
    <th></th>
    <th *ngFor="let title of results.labels.titles" [colSpan]="title.length">{{ title.name }}</th>
  </tr>
  <tr *ngIf="results.labels.subTitles.length > 0">
    <th></th>
    <th *ngFor="let subTitle of results.labels.subTitles" [colSpan]="subTitle.length">{{ subTitle.name }}</th>
  </tr>
  <tr>
    <th>{{ 'date' | t }}</th>
    <th *ngFor="let column of results.labels.columns" [colSpan]="column.length ?? 1">
      <span>{{ column.level ? ('level' | t) + ' ' + column.level : column.name | t }}</span>
      <span *ngIf="column.dataSource && column.dataSource === 'internal' || column.dataSource === 'external'"> ({{ column.dataSource | t }})</span>
    </th>
  </tr>
  <tr *ngIf="results.labels.columnTypes.length > 0">
    <th></th>
    <th *ngFor="let type of results.labels.columnTypes" [colSpan]="type.length">{{ type.name | t }}</th>
  </tr>
  </thead>
  <tbody *ngIf="isProducing">
  <tr>
    <td class="loader-cell" [colSpan]="results.labels.columns.length">
      <div class="loader inline"></div>
    </td>
  </tr>
  </tbody>
  <tbody *ngIf="!isProducing">
  <tr *ngFor="let row of results.rows.items; let rowIndex = index">
    <td *ngFor="let value of row; let first = first; let index = index" [ngStyle]="first ? null : styles[rowIndex][index]">
<!--      {{ first && timeSpace === 'day_in_week' ? (value | lowercase | t) : value }}-->
      {{ value }}
    </td>
  </tr>
  </tbody>
  <tfoot>
  <tr>
    <td>{{ 'total_for_page' | t }}</td>
    <td *ngFor="let total of results.pageTotals">{{ total ?? 0 }}</td>
  </tr>
  <tr>
    <td>{{ 'total' | t }}</td>
    <td *ngFor="let total of results.totals">{{ total ?? 0 }}</td>
  </tr>
  </tfoot>
</table>
<app-pagination [data]="paginationData"></app-pagination>
