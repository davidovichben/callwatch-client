<div class="flex-end">
  <mat-form-field class="w-200p">
    <mat-label>{{ 'select_language' | t  }}</mat-label>
    <mat-select [value]="activeLang" (valueChange)="activeLang = $event">
      <mat-option *ngFor="let lang of langs" [value]="lang.value">{{ lang.label }}</mat-option>
    </mat-select>
  </mat-form-field>
</div>
<div (cdkDropListDropped)="dropMessage($event)" cdkDropList>
  <div class="message" *ngFor="let message of messages; let index = index" cdkDrag>
    <mat-icon id="dragIcon" class="dark-grey-text">drag_indicator</mat-icon>
    <mat-form-field class="w-100p">
      <mat-label>{{ 'type' | t }}</mat-label>
      <mat-select [(ngModel)]="message.contentType">
        <mat-option [value]="type" *ngFor="let type of messageTypes">{{ type | t }}</mat-option>
      </mat-select>
    </mat-form-field>
    <ng-container *ngIf="message.contentType === 'router'">
      <mat-form-field class="w-200p">
        <mat-label>{{ 'select_router' | t }}</mat-label>
        <mat-select [(ngModel)]="message.router">
          <mat-option *ngFor="let router of routers" [value]="router.id">{{ router.name }}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field class="flex-grow-1">
        <mat-label>{{ 'description' | t }}</mat-label>
        <input matInput [(ngModel)]="message.description">
      </mat-form-field>
    </ng-container>
    <ng-container *ngIf="message.contentType === 'message'">
      <app-chips-input class="w-300p" [placeholder]="'tags' | t" [(ngModel)]="message.tags"></app-chips-input>
      <app-audio-input [placeholder]="'audio_file' | t" [inputFile]="message.files[lang.value]" [hidden]="activeLang !== lang.value" (fileChange)="setFile(index, $event)" *ngFor="let lang of langs"></app-audio-input>
      <div class="icon-container pointer" (click)="openActivityDialog(message)">
        <p class="mb-1 bold">{{ 'timing' | t }}</p>
        <mat-icon [ngClass]="{ 'green-text': message.timingType }">watch_later</mat-icon>
        <p>{{ message.timingType ? (message.timingType | t) : ('none' | t) }}</p>
      </div>
      <div class="icon-container">
        <p class="mb-1 bold">{{ 'status' | t }}</p>
        <mat-icon [ngClass]="{ 'green-text': message.isActive, 'red-text': !message.isActive }">power_settings_new</mat-icon>
        <p [ngClass]="{ 'green-text': message.isActive, 'red-text': !message.isActive }">{{ message.isActive ? ('active' | t) : ('inactive' | t) }}</p>
      </div>
    </ng-container>
    <mat-slide-toggle [(ngModel)]="message.isActive"></mat-slide-toggle>
    <mat-icon class="pointer dark-grey-text" (click)="deleteMessage(index)">delete</mat-icon>
  </div>
</div>
<button mat-flat-button type="button" class="mt-3 btn blue-btn" (click)="newMessage()">{{ 'add' | t }}</button>
